<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>CPS Tester • Made by Akash Rawat</title>
  <meta name="description" content="A clean, fast CPS (Clicks Per Second) tester. Made by Akash Rawat." />
  <style>
    :root{
      --bg1:#070a12;
      --bg2:#0b1224;
      --card:rgba(255,255,255,.06);
      --card2:rgba(255,255,255,.10);
      --text:#e9eefc;
      --muted:rgba(233,238,252,.72);
      --line:rgba(255,255,255,.10);
      --accent:#6ae6ff;
      --accent2:#7c5cff;
      --good:#33d17a;
      --warn:#ffb86b;
      --bad:#ff5c7a;
      --shadow: 0 18px 60px rgba(0,0,0,.45);
      --radius: 18px;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      color:var(--text);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans", "Liberation Sans", sans-serif;
      background:
        radial-gradient(900px 500px at 20% 10%, rgba(124,92,255,.20), transparent 60%),
        radial-gradient(900px 500px at 80% 20%, rgba(106,230,255,.18), transparent 60%),
        radial-gradient(900px 500px at 50% 90%, rgba(51,209,122,.10), transparent 60%),
        linear-gradient(180deg, var(--bg1), var(--bg2));
      overflow-x:hidden;
    }

    .wrap{
      max-width:1100px;
      margin:0 auto;
      padding:28px 18px 40px;
    }

    header{
      display:flex;
      gap:14px;
      align-items:flex-start;
      justify-content:space-between;
      margin-bottom:18px;
    }

    .brand{
      display:flex;
      gap:12px;
      align-items:center;
    }

    .logo{
      width:44px;height:44px;
      border-radius:14px;
      background:
        radial-gradient(16px 16px at 30% 30%, rgba(255,255,255,.55), transparent 60%),
        linear-gradient(135deg, rgba(106,230,255,.95), rgba(124,92,255,.95));
      box-shadow: 0 10px 28px rgba(124,92,255,.20), 0 10px 28px rgba(106,230,255,.12);
      position:relative;
      overflow:hidden;
    }
    .logo:after{
      content:"";
      position:absolute; inset:-30% -30%;
      background: conic-gradient(from 180deg, rgba(255,255,255,.0), rgba(255,255,255,.25), rgba(255,255,255,.0));
      animation: spin 3.2s linear infinite;
      opacity:.7;
      filter: blur(0.2px);
    }

    @keyframes spin{to{transform:rotate(360deg)}}

    h1{
      font-size:18px;
      margin:0;
      letter-spacing:.2px;
    }
    .sub{
      margin:3px 0 0;
      color:var(--muted);
      font-size:13px;
      line-height:1.35;
    }

    .top-actions{
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
      justify-content:flex-end;
    }

    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:10px 12px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.04);
      border-radius:999px;
      box-shadow: 0 10px 30px rgba(0,0,0,.18);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      user-select:none;
    }

    .pill b{
      font-weight:700;
      letter-spacing:.2px;
    }

    .grid{
      display:grid;
      grid-template-columns: 1.15fr .85fr;
      gap:14px;
      margin-top:14px;
    }

    @media (max-width: 900px){
      header{flex-direction:column; align-items:stretch}
      .top-actions{justify-content:flex-start}
      .grid{grid-template-columns:1fr}
    }

    .card{
      border:1px solid var(--line);
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.035));
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
      overflow:hidden;
      position:relative;
    }

    .card .inner{padding:16px}

    .title-row{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      margin-bottom:10px;
    }

    .card h2{
      margin:0;
      font-size:14px;
      color:rgba(233,238,252,.92);
      letter-spacing:.2px;
      font-weight:700;
    }

    .hint{
      font-size:12px;
      color:var(--muted);
      margin:0;
    }

    .test-area{
      margin-top:12px;
      border-radius: 16px;
      border:1px dashed rgba(255,255,255,.20);
      background:
        radial-gradient(650px 260px at 20% 20%, rgba(106,230,255,.11), transparent 60%),
        radial-gradient(650px 260px at 80% 30%, rgba(124,92,255,.10), transparent 60%),
        rgba(255,255,255,.03);
      min-height: 360px;
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      text-align:center;
      padding:18px;
      position:relative;
      isolation:isolate;
      cursor:pointer;
      user-select:none;
      outline:none;
      transition: transform .12s ease, border-color .12s ease, background .12s ease;
    }

    .test-area:focus-visible{
      border-color: rgba(106,230,255,.65);
      box-shadow: 0 0 0 4px rgba(106,230,255,.12);
    }

    .test-area:hover{
      border-color: rgba(255,255,255,.28);
    }

    .test-area:active{
      transform: scale(.994);
    }

    .big{
      font-size:34px;
      margin:0;
      letter-spacing:.2px;
      line-height:1.1;
    }

    .small{
      margin:10px 0 0;
      font-size:13px;
      color:var(--muted);
      line-height:1.45;
      max-width: 540px;
    }

    .badge{
      position:absolute;
      top:14px; left:14px;
      display:flex;
      gap:10px;
      align-items:center;
      padding:8px 10px;
      border-radius:999px;
      border:1px solid var(--line);
      background:rgba(0,0,0,.18);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      z-index:2;
    }

    .dot{
      width:10px; height:10px; border-radius:999px;
      background: rgba(255,255,255,.25);
      box-shadow: 0 0 0 4px rgba(255,255,255,.06);
    }

    .dot.live{background: var(--good); box-shadow: 0 0 0 4px rgba(51,209,122,.14)}
    .dot.ready{background: var(--accent); box-shadow: 0 0 0 4px rgba(106,230,255,.14)}
    .dot.done{background: var(--warn); box-shadow: 0 0 0 4px rgba(255,184,107,.14)}

    .badge span{
      font-size:12px;
      color:rgba(233,238,252,.88);
    }

    .pulse{
      position:absolute;
      inset:0;
      pointer-events:none;
      z-index:0;
    }

    .ring{
      position:absolute;
      left:50%; top:50%;
      width: 60px; height:60px;
      border-radius:999px;
      border:1px solid rgba(106,230,255,.0);
      transform: translate(-50%,-50%) scale(.35);
      opacity:0;
    }

    .ring.show{
      animation: ring .45s ease-out;
      border-color: rgba(106,230,255,.50);
    }

    @keyframes ring{
      0%{opacity:.0; transform: translate(-50%,-50%) scale(.25)}
      20%{opacity:.9}
      100%{opacity:0; transform: translate(-50%,-50%) scale(1.55)}
    }

    .stats{
      display:grid;
      grid-template-columns: repeat(2, 1fr);
      gap:10px;
      margin-top:12px;
    }

    @media (max-width: 420px){
      .stats{grid-template-columns:1fr}
      .big{font-size:30px}
    }

    .stat{
      border:1px solid var(--line);
      background: rgba(255,255,255,.04);
      border-radius: 16px;
      padding:12px;
      min-height:74px;
    }

    .label{
      font-size:12px;
      color:var(--muted);
      margin:0 0 6px;
    }

    .value{
      display:flex;
      align-items:baseline;
      gap:8px;
      margin:0;
      font-weight:800;
      letter-spacing:.2px;
      font-size:22px;
    }

    .value small{
      font-size:12px;
      font-weight:700;
      color:rgba(233,238,252,.70);
    }

    .controls{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      margin-top:12px;
      align-items:center;
      justify-content:space-between;
    }

    .left-controls{display:flex; gap:10px; flex-wrap:wrap; align-items:center}

    .btn{
      border:1px solid var(--line);
      background: rgba(255,255,255,.05);
      color:rgba(233,238,252,.95);
      padding:10px 12px;
      border-radius: 14px;
      cursor:pointer;
      font-weight:700;
      letter-spacing:.2px;
      transition: transform .08s ease, background .12s ease, border-color .12s ease;
      user-select:none;
    }
    .btn:hover{background: rgba(255,255,255,.075)}
    .btn:active{transform: translateY(1px)}
    .btn.primary{
      border-color: rgba(106,230,255,.55);
      background: linear-gradient(135deg, rgba(106,230,255,.18), rgba(124,92,255,.14));
      box-shadow: 0 10px 30px rgba(106,230,255,.08);
    }
    .btn.danger{
      border-color: rgba(255,92,122,.45);
      background: linear-gradient(135deg, rgba(255,92,122,.16), rgba(255,255,255,.04));
    }

    .select{
      display:flex;
      align-items:center;
      gap:10px;
      padding:10px 12px;
      border-radius:14px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.04);
    }

    .select label{
      font-size:12px;
      color:var(--muted);
      font-weight:700;
    }

    select{
      appearance:none;
      border:none;
      outline:none;
      background:transparent;
      color:rgba(233,238,252,.95);
      font-weight:800;
      letter-spacing:.2px;
      cursor:pointer;
    }

    .kbd{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      min-width: 26px;
      height: 22px;
      padding:0 8px;
      border-radius:8px;
      border:1px solid rgba(255,255,255,.16);
      background: rgba(0,0,0,.18);
      color: rgba(233,238,252,.92);
      font-size: 11px;
      font-weight:800;
      letter-spacing:.3px;
    }

    .history{
      display:flex;
      flex-direction:column;
      gap:10px;
      margin-top:12px;
      max-height: 420px;
      overflow:auto;
      padding-right: 6px;
    }

    .history::-webkit-scrollbar{width:10px}
    .history::-webkit-scrollbar-thumb{
      background: rgba(255,255,255,.10);
      border: 3px solid rgba(0,0,0,0);
      background-clip: padding-box;
      border-radius:999px;
    }

    .row{
      border:1px solid var(--line);
      background: rgba(255,255,255,.04);
      border-radius: 16px;
      padding:12px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }

    .row .meta{
      display:flex;
      flex-direction:column;
      gap:4px;
    }
    .row .meta b{
      font-size:13px;
      letter-spacing:.2px;
    }
    .row .meta span{
      font-size:12px;
      color:var(--muted);
    }

    .score{
      font-weight:900;
      font-size:18px;
      letter-spacing:.2px;
      display:flex;
      align-items:baseline;
      gap:6px;
      white-space:nowrap;
    }
    .score small{
      font-size:11px;
      color:rgba(233,238,252,.70);
      font-weight:800;
    }

    .footer{
      margin-top:14px;
      padding:12px 2px 0;
      color: rgba(233,238,252,.62);
      font-size:12px;
      display:flex;
      justify-content:space-between;
      flex-wrap:wrap;
      gap:10px;
    }

    .link{
      color: rgba(233,238,252,.75);
      text-decoration:none;
      border-bottom:1px dashed rgba(233,238,252,.30);
    }
    .link:hover{color: rgba(233,238,252,.92); border-bottom-color: rgba(233,238,252,.55)}

    .toast{
      position: fixed;
      left: 50%;
      bottom: 16px;
      transform: translateX(-50%);
      background: rgba(0,0,0,.55);
      border: 1px solid rgba(255,255,255,.14);
      color: rgba(233,238,252,.92);
      padding: 10px 12px;
      border-radius: 14px;
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      box-shadow: 0 18px 60px rgba(0,0,0,.35);
      opacity: 0;
      pointer-events: none;
      transition: opacity .18s ease, transform .18s ease;
      font-size: 12px;
      font-weight: 700;
      letter-spacing: .2px;
      z-index: 50;
    }
    .toast.show{
      opacity: 1;
      transform: translateX(-50%) translateY(-6px);
    }
  </style>
</head>

<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <h1>CPS Tester</h1>
          <p class="sub">Fast, clean click speed test. Click the big area to start. Results save locally in your browser.</p>
        </div>
      </div>

      <div class="top-actions">
        <div class="pill" title="Project credit">
          <span style="opacity:.85">Made by</span>
          <b>Akash Rawat</b>
        </div>
        <div class="pill" title="Keyboard shortcuts">
          <span class="kbd">Space</span>
          <span style="opacity:.75">Start/Stop</span>
          <span class="kbd">R</span>
          <span style="opacity:.75">Reset</span>
        </div>
      </div>
    </header>

    <div class="grid">
      <!-- Main Tester -->
      <section class="card" aria-label="CPS tester">
        <div class="inner">
          <div class="title-row">
            <h2>Click Area</h2>
            <p class="hint" id="statusHint">Ready</p>
          </div>

          <div
            class="test-area"
            id="clickArea"
            tabindex="0"
            role="button"
            aria-label="Click area to test clicks per second"
          >
            <div class="badge" aria-live="polite">
              <div class="dot ready" id="dot"></div>
              <span id="phaseLabel">Ready</span>
            </div>

            <div class="pulse" aria-hidden="true">
              <div class="ring" id="ring"></div>
            </div>

            <p class="big" id="centerTitle">Click to Start</p>
            <p class="small" id="centerSubtitle">
              Choose a duration, then click anywhere inside this box. First click starts the timer.
              Try to keep a steady rhythm.
            </p>
          </div>

          <div class="stats" aria-label="Stats">
            <div class="stat">
              <p class="label">Clicks</p>
              <p class="value"><span id="clicksVal">0</span> <small>total</small></p>
            </div>
            <div class="stat">
              <p class="label">Time</p>
              <p class="value"><span id="timeVal">0.00</span> <small>sec</small></p>
            </div>
            <div class="stat">
              <p class="label">CPS</p>
              <p class="value"><span id="cpsVal">0.00</span> <small>clicks/sec</small></p>
            </div>
            <div class="stat">
              <p class="label">Best CPS (saved)</p>
              <p class="value"><span id="bestVal">—</span> <small>top</small></p>
            </div>
          </div>

          <div class="controls">
            <div class="left-controls">
              <button class="btn primary" id="startBtn" type="button">Start</button>
              <button class="btn" id="stopBtn" type="button" disabled>Stop</button>
              <button class="btn danger" id="resetBtn" type="button">Reset</button>

              <div class="select" title="Test duration">
                <label for="duration">Duration</label>
                <select id="duration">
                  <option value="1">1s</option>
                  <option value="2">2s</option>
                  <option value="5" selected>5s</option>
                  <option value="10">10s</option>
                  <option value="15">15s</option>
                  <option value="30">30s</option>
                  <option value="60">60s</option>
                </select>
              </div>
            </div>

            <button class="btn" id="clearHistoryBtn" type="button" title="Clear saved history on this browser">
              Clear History
            </button>
          </div>

          <div class="footer">
            <span>Tip: Keep your mouse inside the box for accurate clicks.</span>
            <span>
              This page stores results in <span class="kbd">localStorage</span> only.
            </span>
          </div>
        </div>
      </section>

      <!-- Sidebar -->
      <aside class="card" aria-label="History and info">
        <div class="inner">
          <div class="title-row">
            <h2>Recent Runs</h2>
            <p class="hint">Last 12 saved</p>
          </div>

          <div class="history" id="history"></div>

          <div class="footer" style="padding-top:10px">
            <span>
              Export: open DevTools → Application → Local Storage.
            </span>
            <span>
              <a class="link" href="#" id="copyLink">Copy page info</a>
            </span>
          </div>
        </div>
      </aside>
    </div>
  </div>

  <div class="toast" id="toast" role="status" aria-live="polite"></div>

  <script>
    (function(){
      "use strict";

      // Elements
      const clickArea = document.getElementById("clickArea");
      const centerTitle = document.getElementById("centerTitle");
      const centerSubtitle = document.getElementById("centerSubtitle");

      const clicksVal = document.getElementById("clicksVal");
      const timeVal = document.getElementById("timeVal");
      const cpsVal = document.getElementById("cpsVal");
      const bestVal = document.getElementById("bestVal");

      const durationSel = document.getElementById("duration");
      const startBtn = document.getElementById("startBtn");
      const stopBtn = document.getElementById("stopBtn");
      const resetBtn = document.getElementById("resetBtn");
      const clearHistoryBtn = document.getElementById("clearHistoryBtn");

      const statusHint = document.getElementById("statusHint");
      const phaseLabel = document.getElementById("phaseLabel");
      const dot = document.getElementById("dot");
      const ring = document.getElementById("ring");

      const historyBox = document.getElementById("history");
      const toast = document.getElementById("toast");
      const copyLink = document.getElementById("copyLink");

      // State
      let clicks = 0;
      let running = false;
      let done = false;

      let startTime = 0;
      let lastTickTime = 0;
      let rafId = 0;
      let timeoutId = 0;

      const LS_KEY = "akash_cps_history_v1";

      // Helpers
      const now = () => (performance && performance.now) ? performance.now() : Date.now();

      function clamp(n, a, b){ return Math.max(a, Math.min(b, n)); }

      function format2(n){
        return (Math.round(n * 100) / 100).toFixed(2);
      }

      function showToast(msg){
        toast.textContent = msg;
        toast.classList.add("show");
        clearTimeout(showToast._t);
        showToast._t = setTimeout(()=> toast.classList.remove("show"), 1300);
      }

      function pulse(){
        ring.classList.remove("show");
        // reflow to restart animation
        void ring.offsetWidth;
        ring.classList.add("show");
      }

      function setPhase(phase){
        // phase: "ready" | "live" | "done"
        dot.classList.remove("ready","live","done");
        dot.classList.add(phase);
        phaseLabel.textContent = phase === "ready" ? "Ready" : (phase === "live" ? "Live" : "Done");
        statusHint.textContent = phaseLabel.textContent;

        if(phase === "ready"){
          centerTitle.textContent = "Click to Start";
          centerSubtitle.textContent = "Choose a duration, then click anywhere inside this box. First click starts the timer. Try to keep a steady rhythm.";
        }else if(phase === "live"){
          centerTitle.textContent = "Click Fast";
          centerSubtitle.textContent = "Keep clicking until the timer ends. Space can also stop early.";
        }else{
          centerTitle.textContent = "Test Finished";
          centerSubtitle.textContent = "Click Reset to try again, or change duration and press Start.";
        }
      }

      function setButtons(){
        startBtn.disabled = running;
        stopBtn.disabled = !running;
        durationSel.disabled = running;
      }

      function readHistory(){
        try{
          const raw = localStorage.getItem(LS_KEY);
          if(!raw) return [];
          const parsed = JSON.parse(raw);
          return Array.isArray(parsed) ? parsed : [];
        }catch(e){
          return [];
        }
      }

      function writeHistory(list){
        try{
          localStorage.setItem(LS_KEY, JSON.stringify(list));
        }catch(e){
          // ignore
        }
      }

      function addRunToHistory(run){
        const list = readHistory();
        list.unshift(run);
        const trimmed = list.slice(0, 12);
        writeHistory(trimmed);
        renderHistory();
        updateBest();
      }

      function updateBest(){
        const list = readHistory();
        if(!list.length){
          bestVal.textContent = "—";
          return;
        }
        let best = 0;
        for(const r of list){
          if(typeof r.cps === "number" && r.cps > best) best = r.cps;
        }
        bestVal.textContent = format2(best);
      }

      function renderHistory(){
        const list = readHistory();
        historyBox.innerHTML = "";

        if(!list.length){
          const empty = document.createElement("div");
          empty.className = "row";
          empty.innerHTML = `
            <div class="meta">
              <b>No runs saved yet</b>
              <span>Do a test to see history here.</span>
            </div>
            <div class="score">— <small>CPS</small></div>
          `;
          historyBox.appendChild(empty);
          return;
        }

        for(const r of list){
          const row = document.createElement("div");
          row.className = "row";

          const when = new Date(r.ts || Date.now());
          const dateStr = when.toLocaleString(undefined, {
            year: "numeric", month: "short", day: "2-digit",
            hour: "2-digit", minute: "2-digit"
          });

          const cps = (typeof r.cps === "number") ? r.cps : 0;
          const clicksTxt = (typeof r.clicks === "number") ? r.clicks : 0;
          const durTxt = (typeof r.duration === "number") ? r.duration : 0;

          row.innerHTML = `
            <div class="meta">
              <b>${durTxt}s run • ${clicksTxt} clicks</b>
              <span>${dateStr}</span>
            </div>
            <div class="score">${format2(cps)} <small>CPS</small></div>
          `;
          historyBox.appendChild(row);
        }
      }

      function resetState(keepDuration){
        cancelAnimationFrame(rafId);
        clearTimeout(timeoutId);

        clicks = 0;
        running = false;
        done = false;

        startTime = 0;
        lastTickTime = 0;

        clicksVal.textContent = "0";
        timeVal.textContent = "0.00";
        cpsVal.textContent = "0.00";

        setPhase("ready");
        setButtons();

        if(!keepDuration){
          durationSel.value = "5";
        }
      }

      function tick(){
        if(!running) return;
        const t = now();
        const elapsed = (t - startTime) / 1000;
        const dur = Number(durationSel.value) || 5;

        const shownTime = clamp(elapsed, 0, dur);
        timeVal.textContent = format2(shownTime);

        // CPS based on elapsed time so far (avoid division by very small numbers)
        const base = Math.max(0.05, shownTime);
        cpsVal.textContent = format2(clicks / base);

        lastTickTime = t;
        rafId = requestAnimationFrame(tick);
      }

      function finishRun(){
        if(!running) return;
        running = false;
        done = true;

        cancelAnimationFrame(rafId);
        clearTimeout(timeoutId);

        const dur = Number(durationSel.value) || 5;
        const finalTime = dur; // fixed duration result
        const cps = clicks / Math.max(0.001, finalTime);

        timeVal.textContent = format2(finalTime);
        cpsVal.textContent = format2(cps);

        setPhase("done");
        setButtons();

        addRunToHistory({
          ts: Date.now(),
          duration: dur,
          clicks,
          cps
        });

        showToast("Saved to history");
      }

      function startRun(){
        if(running) return;
        if(done) resetState(true);

        clicks = 0;
        running = true;
        done = false;

        clicksVal.textContent = "0";
        timeVal.textContent = "0.00";
        cpsVal.textContent = "0.00";

        setPhase("live");
        setButtons();

        startTime = now();
        lastTickTime = startTime;

        const dur = Number(durationSel.value) || 5;

        tick();
        timeoutId = setTimeout(finishRun, dur * 1000);
      }

      function stopRun(){
        if(!running) return;

        // If stopped early, compute based on elapsed.
        const t = now();
        const elapsed = (t - startTime) / 1000;
        running = false;
        done = true;

        cancelAnimationFrame(rafId);
        clearTimeout(timeoutId);

        const finalTime = Math.max(0.001, elapsed);
        const cps = clicks / finalTime;

        timeVal.textContent = format2(elapsed);
        cpsVal.textContent = format2(cps);

        setPhase("done");
        setButtons();

        addRunToHistory({
          ts: Date.now(),
          duration: Number(durationSel.value) || 5,
          clicks,
          cps,
          stoppedEarly: true
        });

        showToast("Stopped and saved");
      }

      function registerClick(){
        // First click starts run (if not running and not done)
        if(!running && !done){
          startRun();
        }

        if(!running) return;

        clicks++;
        clicksVal.textContent = String(clicks);
        pulse();
      }

      // Events
      clickArea.addEventListener("mousedown", (e) => {
        // Only left click
        if(e.button !== 0) return;
        registerClick();
      });

      // Prevent text selection drag highlighting
      clickArea.addEventListener("dragstart", (e) => e.preventDefault());

      clickArea.addEventListener("keydown", (e) => {
        if(e.code === "Space"){
          e.preventDefault();
          if(running) stopRun();
          else startRun();
        }
        if(e.key.toLowerCase() === "r"){
          e.preventDefault();
          resetState(true);
          showToast("Reset");
        }
      });

      startBtn.addEventListener("click", () => {
        clickArea.focus();
        startRun();
      });

      stopBtn.addEventListener("click", () => {
        clickArea.focus();
        stopRun();
      });

      resetBtn.addEventListener("click", () => {
        clickArea.focus();
        resetState(true);
        showToast("Reset");
      });

      durationSel.addEventListener("change", () => {
        if(running) return;
        if(done){
          // keep results visible but update hint
          showToast("Duration set");
        }
      });

      clearHistoryBtn.addEventListener("click", () => {
        localStorage.removeItem(LS_KEY);
        renderHistory();
        updateBest();
        showToast("History cleared");
      });

      copyLink.addEventListener("click", (e) => {
        e.preventDefault();
        const text =
          "CPS Tester • Made by Akash Rawat\n" +
          "Runs are saved in your browser (localStorage).\n" +
          "Tip: Use Space to Start/Stop and R to Reset.";
        navigator.clipboard?.writeText(text).then(
          () => showToast("Copied"),
          () => showToast("Copy failed")
        );
      });

      // Init
      resetState(true);
      renderHistory();
      updateBest();
      clickArea.focus();
    })();
  </script>
</body>
</html>
